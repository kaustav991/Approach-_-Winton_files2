"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}function _defineProperty(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var PointsMeshGraph=function(){function l(t){var c=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;_classCallCheck(this,l),_defineProperty(this,"_get1xValue",function(t){return t/c.state.devicePixelRatio}),_defineProperty(this,"_v3",function(t,e,s){return new THREE.Vector3(t,e,s)}),_defineProperty(this,"_quaternion",function(t,e,s,i){return t=t||null,e=e||null,s=s||null,i=i||null,new THREE.Quaternion(t,e,s,i)}),_defineProperty(this,"_createUniforms",function(t,e,s){var i=e,n=s;return{color:{value:new THREE.Color(t)},pointSize:{value:i},aValue:{value:n}}}),_defineProperty(this,"_scalePoints",function(t){var e=1;if(c.state.window.width<=1920){c.state.window.width<360?e=.44051:(e=1.1-6525e-8*c.state.window.width)<1&&(e=1);var s=e*t;return s<=20?s:20}return t}),_defineProperty(this,"_createMaterial",function(t){return new THREE.ShaderMaterial({uniforms:t,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,depthTest:!1,transparent:!0,blending:THREE.AdditiveBlending})}),_defineProperty(this,"_generateMultipliers",function(t){for(var e=new Float32Array(t),s=0;s<t;s++)e[s]=Math.min(Math.max(Math.random()/2,.05),.5);return e}),_defineProperty(this,"_getSlerpedQ",function(t,e,s,i){if(i=i||!0){var n=c._quaternion();return THREE.Quaternion.slerp(t,e,n,s),n}var a=THREE.MathUtils.lerp(t.x,e.x,s),r=THREE.MathUtils.lerp(t.y,e.y,s),o=THREE.MathUtils.lerp(t.z,e.z,s),l=THREE.MathUtils.lerp(t.w,e.w,s);return c._quaternion(a,r,o,l)}),_defineProperty(this,"_getNormalisedValue",function(t){return Math.min(Math.max(t.offset/(t.end-t.start),0),1)}),_defineProperty(this,"_getTweenedValues",function(t,e,s,i){var n={};i=i||TWEEN.Easing.Quadratic.InOut;for(var a=Object.keys(t),r=0;r<a.length;r++){var o=t[a[r]],l=e[a[r]]-o;n[a[r]]=i(s)*l+o}return n}),_defineProperty(this,"_getSectionTransitions",function(t){for(var e=t[0],s=t[1],i=0,n=2;n<t.length&&c.state.sectionScroll.val>t[n-1];n++)e=t[n-1],s=t[n],i++;return{start:e,end:s,current:i,offset:c.state.sectionScroll.val-e}}),_defineProperty(this,"_getTransitionPoints",function(t,e){for(var s=e[0],i=e[1],n=0,a=2;a<e.length&&t>e[a-1];a++)s=e[a-1],i=e[a],n++;return{start:s,end:i,current:n}}),_defineProperty(this,"_initRenderer",function(){c.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!1,canvas:c.canvas}),c.renderer.setPixelRatio(window.devicePixelRatio),c.renderer.setSize(window.innerWidth,window.innerHeight),c.renderer.setClearColor(c.settings.backgroundColor,0),c.state.pixelRatio=window.devicePixelRatio,-1<window.navigator.userAgent.indexOf("Android")&&-1<window.navigator.userAgent.indexOf("Chrome")&&(c.state.chromeAndroid=!0,document.body.classList.add("chrome-android")),-1<window.navigator.userAgent.indexOf("Android")&&-1<window.navigator.userAgent.indexOf("SamsungBrowser")&&(c.state.samsung=!0,document.body.classList.add("samsung-browser")),(-1<window.navigator.userAgent.indexOf("iPhone")||-1<window.navigator.userAgent.indexOf("iPad"))&&-1<window.navigator.userAgent.indexOf("Safari")&&(c.state.safari=!0,document.body.classList.add("ios-safari")),(-1<window.navigator.userAgent.indexOf("Edge")||-1<window.navigator.userAgent.indexOf("Trident")||-1<window.navigator.userAgent.indexOf("MSIE"))&&(c.state.edgeOrIE=!0,document.body.classList.add("edge-or-ie")),c.state.ctaButtonEl=document.getElementById("cta")}),_defineProperty(this,"_initControls",function(){c.controls=new THREE.OrbitControls(c.camera,c.settings.canvasEl),c.controls.minAzimuthAngle=-1*Math.PI,c.controls.maxAzimuthAngle=Math.PI,c.controls.maxPolarAngle=Math.PI/2,c.controls.enableDamping=!0,c.controls.dampingFactor=.05,c.controls.minDistance=10,c.controls.maxDistance=400,c.controls.enablePan=!1,c.controls.enableRotate=c.settings.controlsEnabled;for(var t=document.body.querySelectorAll("section"),e=0;e<t.length;e++)t[e].style.pointerEvents="none"}),_defineProperty(this,"_initCamera",function(){c._applyTransitions();var t=c.state.camera.position,e=c.state.lookAt;c.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),c.camera.position.set(t.x,t.y,t.z),c.camera.lookAt(e.x,e.y,e.z),c.camera.zoom=1,c._updateCameraFov(),c.state.camera.rotation=c.camera.quaternion.clone(),c.state.camera.position=c._v3(c.camera.position.x,c.camera.position.y,c.camera.position.z)}),_defineProperty(this,"_checkReducedMotion",function(){var t=window.matchMedia("(prefers-reduced-motion: reduce)");t.matches?(c.settings.reducedMotion=1,document.body.classList.add("reducedMotion")):(c.settings.reducedMotion=0,document.body.classList.remove("reducedMotion")),void 0===c.state.motionListener&&(_typeof("undefined"==t.addEventListener)?c.state.motionListener=t.addListener(c._checkReducedMotion):c.state.motionListener=t.addEventListener("change",c._checkReducedMotion))}),_defineProperty(this,"_applyScaling",function(){c.visuals.uniforms.pointSize.value=c.shaderProps.s1,c.visuals.uniforms2.pointSize.value=c.shaderProps.s2,c.visuals.uniforms.aValue.value=c.shaderProps.a1,c.visuals.uniforms2.aValue.value=c.shaderProps.a2}),_defineProperty(this,"_onWindowResize",function(){c.state.window.width===window.innerWidth&&(c.state.window.height===window.innerHeight||c.state.chromeAndroid||c.state.safari)||(c.state.animating=0,null==c.state.canvasHasResizingClass&&(c.state.canvasHasResizingClass=0),c.state.canvasHasResizingClass||(c.settings.canvasEl.classList.add("resizing"),c.state.canvasHasResizingClass=1),clearTimeout(c.state.debounceResize),c.state.debounceResize=setTimeout(function(){c.settings.canvasEl.classList.remove("resizing"),c.state.canvasHasResizingClass=0,c.state.animating=1,c.camera.aspect=window.innerWidth/window.innerHeight,c.state.window.height=window.innerHeight,c.state.window.width=window.innerWidth,c._updateCameraFov(),c.state.devicePixelRatio!==window.devicePixelRatio&&c.renderer.setPixelRatio(window.devicePixelRatio),c.renderer.setSize(c.state.window.width,c.state.window.height),clearTimeout(c.state.sectionRecalc),c.state.sectionRecalc=setTimeout(function(){c._calculateSectionPositions(),c._applyTransitions(),c._applyScaling()},c.settings.recalcDelay)},c.settings.debounceThreshold))}),_defineProperty(this,"_onPageScroll",function(){clearTimeout(c.state.debounceScroll),c.state.debounceScroll=setTimeout(function(){c.state.ctaButtonEl.classList.remove("scrolling"),c.state.ctaHasScrollingClass=0},c.settings.debounceThreshold),null==c.state.ctaHasScrollingClass&&(c.state.ctaHasScrollingClass=0),c.state.ctaHasScrollingClass||(c.state.ctaButtonEl.classList.add("scrolling"),c.state.ctaHasScrollingClass=1),c.state.tick||c.settings.controlsEnabled||(window.requestAnimationFrame(function(){c._applyTransitions(),c.state.tick=!1}),c.state.tick=!0)}),_defineProperty(this,"_calculateCurrentSection",function(){var t,e=window.scrollY,s=c.state.sectionPositions[0],i=c.state.sectionPositions[1];c.state.currentTransitions.section=0,i<e&&(s=(t=c._getTransitionPoints(e,c.state.sectionPositions)).start,i=t.end,c.state.currentTransitions.section=t.current);var n={start:s,end:i,current:c.state.currentTransitions.section,offset:e-s};return n.normalised=c._getNormalisedValue(n),n.overall=n.normalised+n.current,n}),_defineProperty(this,"_setTransitionState",function(t){c.state.sectionScroll[t]=c._getSectionTransitions(c.transitionPoints[t]),c.state.normalisedScroll[t]=c._getNormalisedValue(c.state.sectionScroll[t]),c.state.currentTransitions[t]=c.state.sectionScroll[t].current}),_defineProperty(this,"_applyTransitions",function(){var t=c._calculateCurrentSection();c.state.sectionScroll.val=t.overall,c._setTransitionState("camera"),c._setTransitionState("shader"),c._setTransitionState("params"),c._setTransitionState("simple"),c.state.normalisedScroll.shader<=1&&c._transitionShader(c.transitions.shader[c.state.currentTransitions.shader],c.transitions.shader[c.state.currentTransitions.shader+1],c.state.normalisedScroll.shader),c.state.normalisedScroll.camera<=1&&1!==c.settings.reducedMotion&&c._transitionCamera(c.transitions.camera[c.state.currentTransitions.camera],c.transitions.camera[c.state.currentTransitions.camera+1],c.state.normalisedScroll.camera),1==c.settings.reducedMotion&&c.state.normalisedScroll.simple<=1&&c._transitionCamera(c.transitions.simple[c.state.currentTransitions.simple],c.transitions.simple[c.state.currentTransitions.simple+1],c.state.normalisedScroll.simple),c.state.normalisedScroll.params<=1&&(c._transitionParams(c.transitions.params[c.state.currentTransitions.params],c.transitions.params[c.state.currentTransitions.params+1],c.state.normalisedScroll.params),c.state.positionNeedsUpdate=!0)}),_defineProperty(this,"_calculateSectionPositions",function(){null==c.state.sections&&(void 0!==window.useSections?"equal"==window.useSections?c.state.sections=document.querySelectorAll("#vis-container .even-spacing section"):c.state.sections=document.querySelectorAll("#vis-container .grouped-spacing section"):c.state.sections=document.querySelectorAll("#vis-container section"));var s=document.getElementById("vis-container").offsetTop;c.state.sectionPositions.splice(0,c.state.sectionPositions.length),c.state.deviceOrientation=c.state.window.width>=c.state.window.height?"landscape":"portrait",c.state.sections.forEach(function(t,e){0==e?c.state.sectionPositions.push(0):c.state.sectionPositions.push(t.offsetTop+s)})}),_defineProperty(this,"_transitionCamera",function(t,e,s){var i=c._getTweenedValues({x:t.position.x,y:t.position.y,z:t.position.z},{x:e.position.x,y:e.position.y,z:e.position.z},s),n=c._v3(i.x,i.y,i.z),a=c._getTweenedValues({x:t.lookAt.x,y:t.lookAt.y,z:t.lookAt.z},{x:e.lookAt.x,y:e.lookAt.y,z:e.lookAt.z},s),r=e.slerp||!1;c.state.camera.moved=!0,c.state.camera.rotation=c._getSlerpedQ(t.quaternion,e.quaternion,s,r),c.state.lookAt=a,c.state.camera.position=n}),_defineProperty(this,"_transitionShader",function(t,e,s){var i=c._getTweenedValues({s1:c._scalePoints(t.shader1.size),s2:c._scalePoints(t.shader2.size),a1:t.shader1.alpha,a2:t.shader2.alpha},{s1:c._scalePoints(e.shader1.size),s2:c._scalePoints(e.shader2.size),a1:e.shader1.alpha,a2:e.shader2.alpha},s,TWEEN.Easing.Sinusoidal.Out);c.shaderProps=i}),_defineProperty(this,"_transitionParams",function(t,e,s){var i=c._getTweenedValues({sa:t.sa,a:t.a,c:t.c,sd:t.sd,d:t.d,e:t.e,f:t.f,j:t.j},{sa:e.sa,a:e.a,c:e.c,sd:e.sd,d:e.d,e:e.e,f:e.f,j:e.j},s,TWEEN.Easing.Sinusoidal.Out),n=c._getTweenedValues({mx:t.mx},{mx:e.mx},s,TWEEN.Easing.Exponential.InOut);i.invsa=1-i.sa,i.invsd=1-i.sd,i.saa=i.sa*i.a,i.sdd=i.sd*i.d,i.mx=n.mx,c.state.params=i}),_defineProperty(this,"_updateCameraFov",function(){c.camera.fov=-37*Math.log(19e-5*c.state.window.width),c.camera.updateProjectionMatrix()}),_defineProperty(this,"_animate",function(){var t,e,s;c.state.camera.moved&&(t=c._quaternion(),e=c.state.camera.position,s=c.state.camera.rotation,c.camera.position.set(e.x,e.y,e.z),t.set(s.x,s.y,s.z,s.w),c.camera.quaternion.copy(t),c.camera.lookAt(c.state.lookAt.x,c.state.lookAt.y,c.state.lookAt.z),c._applyScaling(),c.state.camera.moved=!1),c.settings.controlsEnabled&&c.controls.update(),c.render(),requestAnimationFrame(c._animate)}),this.settings={backgroundColor:2174e3,canvasEl:t,controlsEnabled:!1,debounceThreshold:600,recalcDelay:100,reducedMotion:0,spacingMultiplier:1,spreadMultiplier:30,speed:.0175},this.state={animating:1,camera:{moved:!1,position:null,rotation:null},chromeAndroid:!1,currentTransitions:{},debounceResize:null,dt:0,normalisedScroll:{},positionNeedsUpdate:!1,sections:null,sectionPositions:[],sectionScroll:{},tick:!1,window:{height:window.innerHeight,width:window.innerWidth}},this.vars={},this.visuals={},this.scene=new THREE.Scene,this.visuals.uniforms=this._createUniforms(16777215,20,.6),this.visuals.uniforms2=this._createUniforms(12192815,20,.8),this.shaderProps={s1:this.visuals.uniforms.pointSize.value,s2:this.visuals.uniforms2.pointSize.value,a1:this.visuals.uniforms.aValue.value,a2:this.visuals.uniforms2.aValue.value},this.state.currentTransitions.shader=0,this.state.currentTransitions.camera=0,this.transitionPoints={camera:[0,1.2,1.8,2.5,4,4.6,9],simple:[0,2,4,4.6,9],params:[0,.75,.9,2.1,2.5,3.3,4],shader:[0,.5,1,1.2,1.5,3,3.5,4.5,6.5]},this.transitions={camera:[{position:this._v3(37,1,98),quaternion:this._quaternion(.03981470107450368,.17937699089748216,-.0072657399103494,.9829475539104147),lookAt:this._v3(0,20,0)},{position:this._v3(-7,6,16.8),quaternion:this._quaternion(-.1620738697697587,-.21125516302929367,-.03554543435232294,.9632444336345922),lookAt:this._v3(0,5,0),slerp:!0},{position:this._v3(-29.500578526271205,34.53332792500526,24.539407866538742),quaternion:this._quaternion(-.32435932116889116,-.3963782615213285,-.15209763026713408,.8453056343307478),lookAt:this._v3(0,0,0),slerp:!0},{position:this._v3(-113,63.5,76),quaternion:this._quaternion(.8618581458591542,-.19141491322279833,-.45846788369091124,-.10182370566870198),lookAt:this._v3(-20,0,0)},{position:this._v3(40,94,105.5),quaternion:this._quaternion(-.33402081160614877,.17079824239422445,.06168204304100513,.9249072296048404),lookAt:this._v3(0,0,0)},{position:this._v3(40,94,105.5),quaternion:this._quaternion(-.33402081160614877,.17079824239422445,.06168204304100513,.9249072296048404),lookAt:this._v3(0,0,0)},{position:this._v3(108.95136231749258,256.0357014461075,287.3592181123866),quaternion:this._quaternion(-.33479455851059653,.169450821630382,.0613377909382294,.9248982095578416),lookAt:this._v3(0,0,0)}],simple:[{position:this._v3(37,1,98),quaternion:this._quaternion(.03981470107450368,.17937699089748216,-.0072657399103494,.9829475539104147),lookAt:this._v3(0,20,0)},{position:this._v3(37,1,98),quaternion:this._quaternion(.03981470107450368,.17937699089748216,-.0072657399103494,.9829475539104147),lookAt:this._v3(0,20,0)},{position:this._v3(40,94,105.5),quaternion:this._quaternion(-.33402081160614877,.17079824239422445,.06168204304100513,.9249072296048404),lookAt:this._v3(0,0,0)},{position:this._v3(40,94,105.5),quaternion:this._quaternion(-.33402081160614877,.17079824239422445,.06168204304100513,.9249072296048404),lookAt:this._v3(0,0,0)},{position:this._v3(108.95136231749258,256.0357014461075,287.3592181123866),quaternion:this._quaternion(-.33479455851059653,.169450821630382,.0613377909382294,.9248982095578416),lookAt:this._v3(0,0,0)}],params:[{sa:0,a:0,c:3,sd:0,d:0,e:3,f:1,mx:0,j:0},{sa:1,a:15,c:1,sd:1,d:5,e:1,f:0,mx:0,j:0},{sa:1,a:15,c:1,sd:1,d:5,e:1,f:0,mx:0,j:0},{sa:.5,a:3,c:5,sd:.5,d:1,e:8,f:0,mx:1,j:0},{sa:0,a:0,c:5,sd:0,d:0,e:5,f:0,mx:1,j:0},{sa:0,a:0,c:5,sd:0,d:0,e:5,f:0,mx:1,j:0},{sa:0,a:0,c:3,sd:0,d:0,e:3,f:1,mx:0,j:7}],shader:[{shader1:{size:8,alpha:.5},shader2:{size:8,alpha:.5}},{shader1:{size:10,alpha:.85},shader2:{size:12,alpha:1}},{shader1:{size:20,alpha:.4},shader2:{size:20,alpha:.6}},{shader1:{size:20,alpha:.4},shader2:{size:20,alpha:.6}},{shader1:{size:20,alpha:.8},shader2:{size:20,alpha:1}},{shader1:{size:20,alpha:.8},shader2:{size:20,alpha:1}},{shader1:{size:15,alpha:.4},shader2:{size:15,alpha:.6}},{shader1:{size:15,alpha:.4},shader2:{size:15,alpha:.6}},{shader1:{size:5,alpha:0},shader2:{size:5,alpha:0}}]},this.settings.countX=e,this.settings.countY=s,this.settings.halfCountX=e/2,this.settings.halfCountY=s/2,this.vars.pVisibility=null,this.vars.pVisibility2=null,this.vars.multipliers=null,this.vars.multipliersAlt=null,this._calculateSectionPositions(),this.canvas="OffscreenCanvas"in window?this.settings.canvasEl.transferControlToOffscreen():this.settings.canvasEl,this.canvas.style={width:this._get1xValue(window.innerWidth),height:this._get1xValue(window.innerHeight)},this._initRenderer(),this._initCamera(),this.settings.controlsEnabled&&this._initControls(),this._checkReducedMotion();var i=this.settings.countX*this.settings.countY,n=new Float32Array(3*i);this.vars.rowOffset=new Float32Array(e),this.vars.pVisibility=new Int8Array(i),this.vars.pVisibility2=new Int8Array(i);for(var a=0,r=0;r<this.settings.countX;r+=1){this.vars.rowOffset[r]=.333+Math.random();for(var o=0;o<this.settings.countY;o+=1)n[a]=this.settings.spacingMultiplier*(r-this.settings.countX/2),n[a+1]=0,n[a+2]=this.settings.spacingMultiplier*(o-this.settings.countY/2),this.vars.pVisibility[a]=pixels[a],this.vars.pVisibility[a+1]=pixels[a+1],this.vars.pVisibility[a+2]=pixels[a+2],this.vars.pVisibility2[a]=1-pixels[a],this.vars.pVisibility2[a+1]=1-pixels[a+1],this.vars.pVisibility2[a+2]=1-pixels[a+2],a+=3}this.visuals.geometry=new THREE.BufferGeometry,this.visuals.geometry.setAttribute("position",new THREE.BufferAttribute(n,3)),this.visuals.geometry2=new THREE.BufferGeometry,this.visuals.geometry2.setAttribute("position",new THREE.BufferAttribute(n,3)),this.visuals.geometry.setAttribute("visibility",new THREE.BufferAttribute(this.vars.pVisibility,1)),this.visuals.geometry2.setAttribute("visibility",new THREE.BufferAttribute(this.vars.pVisibility2,1)),this.visuals.material=this._createMaterial(this.visuals.uniforms),this.visuals.material2=this._createMaterial(this.visuals.uniforms2),this.visuals.particles=new THREE.Points(this.visuals.geometry,this.visuals.material),this.visuals.particles2=new THREE.Points(this.visuals.geometry2,this.visuals.material2),this.scene.add(this.visuals.particles),this.scene.add(this.visuals.particles2),this.state.window.width=window.innerWidth,this.state.window.height=window.innerHeight,this.vars.multipliers=this._generateMultipliers(this.settings.countX),this.vars.multipliersAlt=this._generateMultipliers(this.settings.countY)}return _createClass(l,[{key:"render",value:function(){for(var t=this.visuals.particles.geometry.attributes.position.array,e=this.state.params,s=0,i=this.settings.speed*this.state.dt,n=0;n<this.settings.countX;n++)for(var a=0;a<this.settings.countY;a++){this.state.positionNeedsUpdate&&(0<e.j||0<e.mx?(t[s]=(this.settings.spacingMultiplier+e.mx*this.settings.spreadMultiplier)*(n-this.settings.halfCountX)+e.j*this.vars.multipliersAlt[a],0<e.j&&(t[s+2]=this.settings.spacingMultiplier*(a-this.settings.halfCountY)+e.j*this.vars.multipliersAlt[n])):(this.state.resetX||this.state.resetJ)&&(t[s]=this.settings.spacingMultiplier*(n-this.settings.halfCountX),t[s+2]=this.settings.spacingMultiplier*(a-this.settings.halfCountY)));var r=0,r=0!==e.sa?(e.invsa+e.saa*this.vars.multipliers[n])*(e.c*Math.sin(n/8+i)):e.c*Math.sin(n/8+i);0!==e.sd?r+=(e.invsd+e.sdd*this.vars.multipliers[a])*(e.e*Math.cos(a/8+i)+e.f*this.vars.rowOffset[a]):r+=e.e*Math.cos(a/8+i)+e.f*this.vars.rowOffset[a],t[s+1]=r,s+=3}this.state.positionNeedsUpdate&&(this.state.positionNeedsUpdate=!1),this.state.resetX=0!=e.mx,this.state.resetJ=0!=e.j,this.state.animating&&(this.visuals.particles.geometry.attributes.position.needsUpdate=!0,this.visuals.particles2.geometry.attributes.position.needsUpdate=!0),this.renderer.render(this.scene,this.camera),this.state.animating&&!this.settings.reducedMotion&&(this.state.dt+=1)}}]),l}(),splashElement=document.getElementById("vis-container"),splashCanvas=splashElement.querySelector("canvas"),splashBanner=new PointsMeshGraph(splashCanvas);splashBanner._animate(),window.addEventListener("resize",splashBanner._onWindowResize,!1),window.addEventListener("scroll",splashBanner._onPageScroll,!1);